import{a as M,f as O}from"../chunks/CMr_Z6yQ.js";import"../chunks/f-bbM6lp.js";import{c as Ee,o as Re,a as Ie}from"../chunks/iLjeF4RL.js";import{k as Me,I as Oe,a_ as _e,aN as Te,at as Le,b as Ue,a$ as Se,b0 as Ae,b1 as Ce,b2 as $e,q as Pe,o as H,w as ie,R as oe,U as x,W as A,g as o,V as b,S as V,T as le,av as N,aw as u}from"../chunks/BcHN-y2m.js";import{a as We,s as ae}from"../chunks/DAMY3TEN.js";import{i as X}from"../chunks/Ct9SD0M1.js";import{a as je,s as De}from"../chunks/D9xdxD4A.js";import{e as F}from"../chunks/BSrX1ito.js";import{i as de}from"../chunks/BNrjs06Z.js";const G={tick:e=>requestAnimationFrame(e),now:()=>performance.now(),tasks:new Set};function ce(){const e=G.now();G.tasks.forEach(t=>{t.c(e)||(G.tasks.delete(t),t.f())}),G.tasks.size!==0&&G.tick(ce)}function ee(e,t){ie(()=>{e.dispatchEvent(new CustomEvent(t))})}function Be(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(c=>c[0].toUpperCase()+c.slice(1)).join("")}function ue(e){const t={},c=e.split(";");for(const r of c){const[a,i]=r.split(":");if(!a||i===void 0)break;t[Be(a.trim())]=i.trim()}return t}const Ne=e=>e;function te(e,t,c,r){var a,i,n,s=(e&Ae)!==0,v=(e&Ce)!==0,g=(e&Se)!==0,f=s&&v?"both":s?"in":"out",_=t.inert,$=t.style.overflow;function T(){return ie(()=>a??=c()(t,r?.()??{},{direction:f}))}var L={is_global:g,in(){if(t.inert=_,!s)return n?.abort(),void n?.reset?.();v||i?.abort(),i=ne(t,T(),n,1,()=>{ee(t,"introend"),i?.abort(),i=a=void 0,t.style.overflow=$})},out(S){if(!v)return S?.(),void(a=void 0);t.inert=!0,n=ne(t,T(),i,0,()=>{ee(t,"outroend"),S?.()})},stop:()=>{i?.abort(),n?.abort()}},m=Me;if((m.nodes.t??=[]).push(L),s&&We){var R=g;if(!R){for(var I=m.parent;I&&(I.f&Oe)!==0;)for(;(I=I.parent)&&(I.f&_e)===0;);R=!I||(I.f&Te)!==0}R&&Le(()=>{Ue(()=>L.in())})}}function ne(e,t,c,r,a){var i=r===1;if($e(t)){var n,s=!1;return Pe(()=>{if(!s){var R=t({direction:i?"in":"out"});n=ne(e,R,c,r,a)}}),{abort:()=>{s=!0,n?.abort()},deactivate:()=>n.deactivate(),reset:()=>n.reset(),t:()=>n.t()}}if(c?.deactivate(),!t?.duration&&!t?.delay)return ee(e,i?"introstart":"outrostart"),a(),{abort:H,deactivate:H,reset:H,t:()=>r};const{delay:v=0,css:g,tick:f,easing:_=Ne}=t;var $=[];if(i&&c===void 0&&(f&&f(0,1),g)){var T=ue(g(0,1));$.push(T,T)}var L=()=>1-r,m=e.animate($,{duration:v,fill:"forwards"});return m.onfinish=()=>{m.cancel(),ee(e,i?"introstart":"outrostart");var R=c?.t()??1-r;c?.abort();var I=r-R,S=t.duration*Math.abs(I),Y=[];if(S>0){var J=!1;if(g)for(var Q=Math.ceil(S/(1e3/60)),d=0;d<=Q;d+=1){var l=R+I*_(d/Q),h=ue(g(l,1-l));Y.push(h),J||=h.overflow==="hidden"}J&&(e.style.overflow="hidden"),L=()=>{var k=m.currentTime;return R+I*_(k/S)},f&&(function(k){let j;G.tasks.size===0&&G.tick(ce),new Promise(U=>{G.tasks.add(j={c:k,f:U})})})(()=>{if(m.playState!=="running")return!1;var k=L();return f(k,1-k),!0})}(m=e.animate(Y,{duration:S,fill:"forwards"})).onfinish=()=>{L=()=>r,f?.(r,1-r),a()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=H)},deactivate:()=>{a=H},reset:()=>{r===0&&f?.(1,0)},t:()=>L()}}const Fe=Object.freeze(Object.defineProperty({__proto__:null,csr:!0,prerender:!0,ssr:!0},Symbol.toStringTag,{value:"Module"})),Ge=e=>e;function ze(e){const t=e-1;return t*t*t+1}function fe(e){const t=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}function se(e,{delay:t=0,duration:c=400,easing:r=Ge}={}){const a=+getComputedStyle(e).opacity;return{delay:t,duration:c,easing:r,css:i=>"opacity: "+i*a}}function Xe(e,{delay:t=0,duration:c=400,easing:r=ze,x:a=0,y:i=0,opacity:n=0}={}){const s=getComputedStyle(e),v=+s.opacity,g=s.transform==="none"?"":s.transform,f=v*(1-n),[_,$]=fe(a),[T,L]=fe(i);return{delay:t,duration:c,easing:r,css:(m,R)=>`
			transform: ${g} translate(${(1-m)*_}${$}, ${(1-m)*T}${L});
			opacity: ${v-f*R}`}}var Ze=O('<div class="bg-primary-500/10 pointer-events-none absolute inset-0 rounded-xl"></div>'),qe=O('<div role="button" tabindex="0"><input type="file" id="fileInput" class="hidden" accept="image/*"/> <div class="pointer-events-none flex flex-col items-center gap-4"><div class="group-hover:text-primary-500 rounded-full bg-slate-100 p-4 text-slate-500 transition-transform duration-300 group-hover:scale-110 dark:bg-slate-800 dark:text-slate-400"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-8 w-8"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"></path></svg></div> <div class="space-y-1"><p class="text-lg font-medium text-slate-700 dark:text-slate-200">Upload an image</p> <p class="text-sm text-slate-500 dark:text-slate-400">Drag and drop or click to select</p></div></div> <!></div>');function Ke(e){return new Worker(""+new URL("../workers/ocr.worker-XRK-BPfo.js",import.meta.url).href,{name:e?.name})}const q={MODELS:{RECOGNITION:"/monocr.onnx",CHARSET:"/charset.txt"},WORKER:{TIMEOUT_MS:6e4,MAX_RETRIES:3},UI:{MAX_IMAGE_SIZE_MB:10,ALLOWED_FILE_TYPES:["image/jpeg","image/png","image/webp"]}};class z extends Error{constructor(t,c,r){super(t),this.code=c,this.originalError=r,this.name="OcrError"}}let W=null,K=null;const C=new Map;function pe(){W&&(W.terminate(),W=null),K=null;for(const{reject:e}of C.values())e(new z("Cleanup called","Worker_ERROR"));C.clear()}function ve(e,t,c=[],r=q.WORKER.TIMEOUT_MS){const a=crypto.randomUUID(),i=(W||(W=new Ke,W.onmessage=n=>{const{id:s,type:v,payload:g}=n.data;if(C.has(s)){const{resolve:f,reject:_}=C.get(s);C.delete(s),v==="ERROR"?_(new z(g,"Worker_ERROR")):f(g)}},W.onerror=n=>{for(const{reject:s}of C.values())s(new z("Worker terminated unexpectedly","Worker_ERROR"));C.clear(),W=null,K=null}),W);return new Promise((n,s)=>{const v=setTimeout(()=>{C.has(a)&&(C.delete(a),s(new z("Request timed out","TIMEOUT")))},r);C.set(a,{resolve:f=>{clearTimeout(v),n(f)},reject:f=>{clearTimeout(v),s(f)}});const g={id:a,type:e,payload:t};i.postMessage(g,c)})}async function me(){return K||(K=(async()=>{try{await ve("INIT",{modelPath:q.MODELS.RECOGNITION,charsetPath:q.MODELS.CHARSET})}catch(e){throw K=null,e instanceof z?e:new z(`Initialization failed: ${e}`,"INIT_FAILED",e)}})(),K)}typeof window<"u"&&window.addEventListener("beforeunload",()=>pe());var He=O('<div class="inline-flex animate-pulse items-center gap-2 rounded-full bg-blue-100/50 px-4 py-2 text-sm font-medium text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"><div class="h-2 w-2 rounded-full bg-current"></div> Initializing Engine...</div>'),Ve=O('<div class="inline-flex items-center gap-2 rounded-full bg-red-100/50 px-4 py-2 text-sm font-medium text-red-700 dark:bg-red-900/30 dark:text-red-300"><div class="h-2 w-2 rounded-full bg-current"></div> </div>'),Ye=O('<div class="inline-flex items-center gap-2 rounded-full bg-emerald-100/50 px-4 py-2 text-sm font-medium text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-300"><div class="h-2 w-2 rounded-full bg-current"></div> Engine Ready</div>'),Je=O("<div><!></div>"),Qe=O('<span class="font-mono text-xs text-slate-400"> </span>'),et=O('<div class="absolute inset-0 z-10 flex items-center justify-center bg-white/80 backdrop-blur-sm dark:bg-slate-800/80"><div class="flex flex-col items-center gap-3"><div class="border-primary-500 h-8 w-8 animate-spin rounded-full border-4 border-t-transparent"></div> <span class="text-sm font-medium text-slate-600 dark:text-slate-300">Scanning...</span></div></div>'),tt=O('<div class="prose max-w-none dark:prose-invert"><p class="font-mon text-lg leading-relaxed whitespace-pre-wrap text-slate-700 dark:text-slate-300 svelte-1uha8ag"> </p></div>'),rt=O('<div class="flex h-full items-center justify-center text-slate-400 italic">No text extracted</div>'),at=O('<div class="flex justify-end border-t border-slate-100 bg-slate-50 px-4 py-3 dark:border-slate-700 dark:bg-slate-800/50"><button class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 text-sm font-medium transition-colors">Copy Text</button></div>'),nt=O('<div class="grid items-start gap-8 md:grid-cols-2"><div class="space-y-4"><div class="relative overflow-hidden rounded-xl border border-slate-200 bg-slate-200 shadow-sm dark:border-slate-700 dark:bg-slate-800"><img alt="Preview" class="h-auto max-h-[500px] w-full object-contain"/></div> <button class="hover:text-primary-600 hover:decoration-primary-300 text-sm text-slate-500 underline decoration-slate-300 underline-offset-4 transition-colors">Process another image</button></div> <div class="flex h-full min-h-[300px] flex-col overflow-hidden rounded-xl border border-slate-200 bg-white shadow-sm dark:border-slate-700 dark:bg-slate-800"><div class="flex items-center justify-between border-b border-slate-100 bg-slate-50/50 px-6 py-4 dark:border-slate-700 dark:bg-slate-800/50"><h2 class="font-semibold text-slate-800 dark:text-slate-200">Extracted Text</h2> <!></div> <div class="relative flex-1 p-6"><!> <!></div> <!></div></div>'),st=O(`<div class="selection:bg-primary-500/30 min-h-screen bg-slate-50 font-sans text-slate-900 dark:bg-slate-900 dark:text-slate-100"><div class="mx-auto max-w-4xl px-6 py-12"><header class="mb-12 space-y-4 text-center"><h1 class="from-primary-600 dark:from-primary-400 bg-gradient-to-r to-indigo-600 bg-clip-text text-4xl font-extrabold tracking-tight text-transparent md:text-5xl dark:to-indigo-400">MonOCR Web</h1> <p class="mx-auto max-w-2xl text-lg text-slate-600 dark:text-slate-400">Mon OCR that runs entirely in your browser \u2014 fast, private, and built to help bring Mon texts
				into the digital world.</p> <!></header> <main id="main-content" class="space-y-8"><!></main></div></div>`);function it(e,t){oe(t,!1);let c=N(!1),r=N(!1),a=N(null),i=N(null),n=N(null),s=N(null),v=N(0);async function g(d){if(!o(c))return;const l=d.detail;if(l)if(l.size>1024*q.UI.MAX_IMAGE_SIZE_MB*1024)u(a,`File too large (Max ${q.UI.MAX_IMAGE_SIZE_MB}MB)`);else if(q.UI.ALLOWED_FILE_TYPES.includes(l.type)){if(u(i,l),u(s,null),u(a,null),o(n))try{URL.revokeObjectURL(o(n))}catch{}u(n,URL.createObjectURL(o(i))),(async function(){if(o(i))try{u(r,!0);const h=performance.now(),k=await o(i).arrayBuffer(),j=new Uint8Array(k),U=await(async function(D){try{return await me(),await ve("RECOGNIZE",D)}catch(B){throw B instanceof z?B:new z(`Recognition failed: ${B}`,"RECOGNIZE_FAILED",B)}})(j);u(s,U);const E=performance.now();u(v,Math.round(E-h))}catch(h){u(a,`OCR Failed: ${h.message||h}`)}finally{u(r,!1)}})()}else u(a,"Invalid file type. Allowed: JPG, PNG, WEBP")}function f(){if(u(i,null),o(n))try{URL.revokeObjectURL(o(n))}catch{}u(n,null),u(s,null),u(a,null)}Re(async()=>{try{u(r,!0),await me(),u(c,!0)}catch(d){u(a,`Failed to load OCR engine: ${d.message||d}`)}finally{u(r,!1)}}),Ie(()=>{pe(),o(n)&&URL.revokeObjectURL(o(n))}),de();var _=st(),$=x(_),T=x($),L=A(x(T),4),m=d=>{var l=He();M(d,l)},R=d=>{var l=Ve(),h=A(x(l));b(l),V(()=>ae(h,` ${o(a)??""}`)),M(d,l)},I=d=>{var l=Ye();te(1,l,()=>se),M(d,l)};X(L,d=>{o(c)||o(a)?o(a)?d(R,1):d(I,!1):d(m)}),b(T);var S=A(T,2),Y=x(S),J=d=>{var l=Je();(function(h,k){oe(k,!1);const j=Ee();let U=N(!1);de();var E=qe(),D=x(E),B=A(D,4),re=y=>{var P=Ze();te(3,P,()=>se),M(y,P)};X(B,y=>{o(U)&&y(re)}),b(E),V(()=>je(E,1,`group relative cursor-pointer rounded-xl border-2 border-dashed p-12 text-center transition-all duration-300 ease-in-out
           `+(o(U)?"border-primary-500 bg-primary-50/10 scale-[1.02]":"hover:border-primary-400 border-slate-300 hover:bg-slate-50 dark:border-slate-700 dark:hover:bg-slate-800/50"))),F("change",D,function(y){const P=y.target;P.files&&P.files.length>0&&j("file",P.files[0])}),F("dragover",E,function(y){y.preventDefault(),u(U,!0)}),F("dragleave",E,function(){u(U,!1)}),F("drop",E,function(y){y.preventDefault(),u(U,!1),y.dataTransfer?.files&&y.dataTransfer.files.length>0&&j("file",y.dataTransfer.files[0])}),F("keypress",E,()=>document.getElementById("fileInput")?.click()),F("click",E,()=>document.getElementById("fileInput")?.click()),M(h,E),le()})(x(l),{$$events:{file:g}}),b(l),te(1,l,()=>se,()=>({duration:300})),M(d,l)},Q=d=>{var l=nt(),h=x(l),k=x(h),j=x(k);b(k);var U=A(k,2);b(h);var E=A(h,2),D=x(E),B=A(x(D),2),re=p=>{var w=Qe(),Z=x(w);b(w),V(()=>ae(Z,`${o(v)??""}ms`)),M(p,w)};X(B,p=>{o(v)>0&&!o(r)&&p(re)}),b(D);var y=A(D,2),P=x(y),xe=p=>{var w=et();M(p,w)};X(P,p=>{o(r)&&p(xe)});var be=A(P,2),ge=p=>{var w=tt(),Z=x(w),ke=x(Z,!0);b(Z),b(w),V(()=>ae(ke,o(s))),M(p,w)},ye=p=>{var w=rt();M(p,w)};X(be,p=>{o(s)?p(ge):o(r)||p(ye,1)}),b(y);var he=A(y,2),we=p=>{var w=at(),Z=x(w);b(w),F("click",Z,()=>navigator.clipboard.writeText(o(s)||"")),M(p,w)};X(he,p=>{o(s)&&p(we)}),b(E),b(l),V(()=>De(j,"src",o(n))),F("click",U,f),te(1,l,()=>Xe,()=>({y:20,duration:400})),M(d,l)};X(Y,d=>{o(i)?d(Q,!1):d(J)}),b(S),b($),b(_),M(e,_),le()}export{it as component,Fe as universal};
