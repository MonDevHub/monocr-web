try{self["workbox:window:7.3.0"]&&_()}catch{}function m(n,r){return new Promise(function(t){var i=new MessageChannel;i.port1.onmessage=function(u){t(u.data)},n.postMessage(r,[i.port2])})}function P(n,r){(r==null||r>n.length)&&(r=n.length);for(var t=0,i=Array(r);t<r;t++)i[t]=n[t];return i}function j(n,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,W(i.key),i)}}function S(n,r){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t)return(t=t.call(n)).next.bind(t);if(Array.isArray(n)||(t=(function(u,f){if(u){if(typeof u=="string")return P(u,f);var a={}.toString.call(u).slice(8,-1);return a==="Object"&&u.constructor&&(a=u.constructor.name),a==="Map"||a==="Set"?Array.from(u):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?P(u,f):void 0}})(n))||r){t&&(n=t);var i=0;return function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y(n,r){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},y(n,r)}function W(n){var r=(function(t){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var u=i.call(t,"string");if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)})(n);return typeof r=="symbol"?r:r+""}try{self["workbox:core:7.3.0"]&&_()}catch{}var w=function(){var n=this;this.promise=new Promise(function(r,t){n.resolve=r,n.reject=t})};function b(n,r){var t=location.href;return new URL(n,t).href===new URL(r,t).href}var d=function(n,r){this.type=n,Object.assign(this,r)};function l(n,r,t){return t?r?r(n):n:(n&&n.then||(n=Promise.resolve(n)),r?n.then(r):n)}function k(){}var L={type:"SKIP_WAITING"};function E(n,r){return n&&n.then?n.then(k):Promise.resolve()}var O=(function(n){function r(f,a){var e,o;return a===void 0&&(a={}),(e=n.call(this)||this).nn={},e.tn=0,e.rn=new w,e.en=new w,e.on=new w,e.un=0,e.an=new Set,e.cn=function(){var c=e.fn,s=c.installing;e.tn>0||!b(s.scriptURL,e.sn.toString())||performance.now()>e.un+6e4?(e.vn=s,c.removeEventListener("updatefound",e.cn)):(e.hn=s,e.an.add(s),e.rn.resolve(s)),++e.tn,s.addEventListener("statechange",e.ln)},e.ln=function(c){var s=e.fn,v=c.target,h=v.state,p=v===e.vn,g={sw:v,isExternal:p,originalEvent:c};!p&&e.mn&&(g.isUpdate=!0),e.dispatchEvent(new d(h,g)),h==="installed"?e.wn=self.setTimeout(function(){h==="installed"&&s.waiting===v&&e.dispatchEvent(new d("waiting",g))},200):h==="activating"&&(clearTimeout(e.wn),p||e.en.resolve(v))},e.yn=function(c){var s=e.hn,v=s!==navigator.serviceWorker.controller;e.dispatchEvent(new d("controlling",{isExternal:v,originalEvent:c,sw:s,isUpdate:e.mn})),v||e.on.resolve(s)},e.gn=(o=function(c){var s=c.data,v=c.ports,h=c.source;return l(e.getSW(),function(){e.an.has(h)&&e.dispatchEvent(new d("message",{data:s,originalEvent:c,ports:v,sw:h}))})},function(){for(var c=[],s=0;s<arguments.length;s++)c[s]=arguments[s];try{return Promise.resolve(o.apply(this,c))}catch(v){return Promise.reject(v)}}),e.sn=f,e.nn=a,navigator.serviceWorker.addEventListener("message",e.gn),e}var t,i;i=n,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,y(t,i);var u=r.prototype;return u.register=function(f){var a=(f===void 0?{}:f).immediate,e=a!==void 0&&a;try{var o=this;return l((function(c,s){var v=c();return v&&v.then?v.then(s):s()})(function(){if(!e&&document.readyState!=="complete")return E(new Promise(function(c){return window.addEventListener("load",c)}))},function(){return o.mn=!!navigator.serviceWorker.controller,o.dn=o.pn(),l(o.bn(),function(c){o.fn=c,o.dn&&(o.hn=o.dn,o.en.resolve(o.dn),o.on.resolve(o.dn),o.dn.addEventListener("statechange",o.ln,{once:!0}));var s=o.fn.waiting;return s&&b(s.scriptURL,o.sn.toString())&&(o.hn=s,Promise.resolve().then(function(){o.dispatchEvent(new d("waiting",{sw:s,wasWaitingBeforeRegister:!0}))}).then(function(){})),o.hn&&(o.rn.resolve(o.hn),o.an.add(o.hn)),o.fn.addEventListener("updatefound",o.cn),navigator.serviceWorker.addEventListener("controllerchange",o.yn),o.fn})}))}catch(c){return Promise.reject(c)}},u.update=function(){try{return this.fn?l(E(this.fn.update())):l()}catch(f){return Promise.reject(f)}},u.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},u.messageSW=function(f){try{return l(this.getSW(),function(a){return m(a,f)})}catch(a){return Promise.reject(a)}},u.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&m(this.fn.waiting,L)},u.pn=function(){var f=navigator.serviceWorker.controller;return f&&b(f.scriptURL,this.sn.toString())?f:void 0},u.bn=function(){try{var f=this;return l((function(a,e){try{var o=a()}catch(c){return e(c)}return o&&o.then?o.then(void 0,e):o})(function(){return l(navigator.serviceWorker.register(f.sn,f.nn),function(a){return f.un=performance.now(),a})},function(a){throw a}))}catch(a){return Promise.reject(a)}},(function(f,a){return a&&j(f.prototype,a),Object.defineProperty(f,"prototype",{writable:!1}),f})(r,[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])})((function(){function n(){this.Pn=new Map}var r=n.prototype;return r.addEventListener=function(t,i){this.jn(t).add(i)},r.removeEventListener=function(t,i){this.jn(t).delete(i)},r.dispatchEvent=function(t){t.target=this;for(var i,u=S(this.jn(t.type));!(i=u()).done;)(0,i.value)(t)},r.jn=function(t){return this.Pn.has(t)||this.Pn.set(t,new Set),this.Pn.get(t)},n})());export{O as Workbox,d as WorkboxEvent,m as messageSW};
