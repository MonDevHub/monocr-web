import{v as l,x as v,y as r,z as g,A as d,B as u,C as c,D as k,E as w,F as b,G as M,H as _,I as y,J as A,K as D,L as F,M as x,N as B,O as m}from"./BcHN-y2m.js";class p{anchor;#t=new Map;#s=new Map;#e=new Map;#i=new Set;#a=!0;constructor(s,i=!0){this.anchor=s,this.#a=i}#n=()=>{var s=l;if(this.#t.has(s)){var i=this.#t.get(s),t=this.#s.get(i);if(t)v(t),this.#i.delete(i);else{var f=this.#e.get(i);f&&(this.#s.set(i,f.effect),this.#e.delete(i),f.fragment.lastChild.remove(),this.anchor.before(f.fragment),t=f.effect)}for(const[e,a]of this.#t){if(this.#t.delete(e),e===s)break;const n=this.#e.get(a);n&&(r(n.effect),this.#e.delete(a))}for(const[e,a]of this.#s){if(e===i||this.#i.has(e))continue;const n=()=>{if(Array.from(this.#t.values()).includes(e)){var o=document.createDocumentFragment();w(a,o),o.append(d()),this.#e.set(e,{effect:a,fragment:o})}else r(a);this.#i.delete(e),this.#s.delete(e)};this.#a||!t?(this.#i.add(e),g(a,n,!1)):n()}}};#f=s=>{this.#t.delete(s);const i=Array.from(this.#t.values());for(const[t,f]of this.#e)i.includes(t)||(r(f.effect),this.#e.delete(t))};ensure(s,i){var t=l,f=b();if(i&&!this.#s.has(s)&&!this.#e.has(s))if(f){var e=document.createDocumentFragment(),a=d();e.append(a),this.#e.set(s,{effect:u(()=>i(a)),fragment:e})}else this.#s.set(s,u(()=>i(this.anchor)));if(this.#t.set(t,s),f){for(const[n,o]of this.#s)n===s?t.unskip_effect(o):t.skip_effect(o);for(const[n,o]of this.#e)n===s?t.unskip_effect(o.effect):t.skip_effect(o.effect);t.oncommit(this.#n),t.ondiscard(this.#f)}else c&&(this.anchor=k),this.#n()}}function C(h,s,i=!1){c&&_();var t=new p(h);function f(e,a){if(c){const o=A(h);if(e!==(o===D?0:o!==F&&parseInt(o.substring(1)))){var n=x();return B(n),t.anchor=n,m(!1),t.ensure(e,a),void m(!0)}}t.ensure(e,a)}M(()=>{var e=!1;s((a,n=0)=>{e=!0,f(n,a)}),e||f(!1,null)},i?y:0)}export{p as B,C as i};
